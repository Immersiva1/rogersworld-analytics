var e=Object.defineProperty,t=Object.defineProperties,o=Object.getOwnPropertyDescriptors,d=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,i=(t,o,d)=>o in t?e(t,o,{enumerable:!0,configurable:!0,writable:!0,value:d}):t[o]=d,a=(e,t)=>{for(var o in t||(t={}))r.call(t,o)&&i(e,o,t[o]);if(d)for(var o of d(t))n.call(t,o)&&i(e,o,t[o]);return e},s=(e,d)=>t(e,o(d));const m=e=>{const{prefix:t=[],track:o,stickyContext:d}=e;return e=>{const{name:r,requiredContext:n=[],optionalContext:i=[]}=e,a=[t,r].flat();return Object.assign(((e={})=>{const t=((e,t={},o=[],d=[])=>{const r={};return o.forEach((o=>{var d;const n=null!=(d=t[o])?d:e[o];if(void 0===n)throw new Error("Required context missing: "+o);r[o]=n})),d.forEach((o=>{var d;r[o]=null!=(d=t[o])?d:e[o]})),r})(d,e,n,i);o(a,t)}),{recordingName:a,requiredContext:n,optionalContext:i})}},p=["userId","userEmail","userName"],c=e=>{const{Page:t,Event:o,saveContext:d}=(e=>{const{prefix:t,provider:{trackPageView:o,trackEvent:d},stickyContext:r={}}=e;return{saveContext:e=>Object.assign(r,e),Page:m({prefix:t,stickyContext:r,track:o}),Event:m({prefix:t,stickyContext:r,track:d})}})({provider:e,prefix:"Web App"});return{saveContext:d,pages:{home:t({name:"Home"}),auth:t({name:"Auth"}),payment:t({name:"Payment",requiredContext:p})},events:{auth:{signedUp:o({name:["Auth","Signed Up"],requiredContext:p}),loggedIn:o({name:["Auth","Logged In"],requiredContext:p}),loggedOut:o({name:["Auth","Logged Out"],requiredContext:p}),canceled:o({name:["Auth","Canceled"]}),required:o({name:["Auth","Required"],requiredContext:["episodeId"]})},payment:{required:o({name:["Payment","Required"],requiredContext:p}),completed:o({name:["Payment","Completed"],requiredContext:p})},episode:{detailsViewed:o({name:["Episode","Details Viewed"],requiredContext:["episodeId"],optionalContext:p})},device:{connected:o({name:["Device","Connected"],requiredContext:["roomId","episodeId","deviceId"]}),disconnected:o({name:["Device","Disconnected"],requiredContext:["roomId","episodeId","deviceId"]})},room:{created:o({name:["Room","Created"],requiredContext:["roomId","episodeId",...p]}),exited:o({name:["Room","Exited"],requiredContext:["roomId","episodeId",...p]}),backToAllEpisodes:o({name:["Room","Back to All Episodes"],requiredContext:["roomId","episodeId",...p]}),joined:o({name:["Room","Joined"],requiredContext:["roomId","episodeId","deviceId","playerId"],optionalContext:["playerAge"]}),episodeStarted:o({name:["Room","Episode Started"],requiredContext:["roomId","episodeId",...p]}),episodeCompleted:o({name:["Room","Episode Completed"],requiredContext:["roomId","episodeId",...p]})},scene:{started:o({name:["Scene","Started"],requiredContext:["sceneId","roomId","episodeId",...p]}),completed:o({name:["Scene","Completed"],requiredContext:["sceneId","roomId","episodeId",...p]}),skipped:o({name:["Scene","Skipped"],requiredContext:["sceneId","roomId","episodeId",...p]}),video:{segmentStarted:o({name:["Scene","Video","Segment Started"],requiredContext:["roomId","episodeId","sceneId","videoId","timestamp",...p]}),segmentCompleted:o({name:["Scene","Video","Segment Completed"],requiredContext:["roomId","episodeId","sceneId","videoId","timestamp",...p]}),autoplayPrevented:o({name:["Scene","Video","Autoplay Prevented"],requiredContext:["roomId","episodeId","sceneId","videoId"]}),paused:o({name:["Scene","Video","Paused"],requiredContext:["roomId","episodeId","sceneId","videoId","timestamp"]}),resumed:o({name:["Scene","Video","Resumed"],requiredContext:["roomId","episodeId","sceneId","sceneIndex","scenesRemaining","sceneProgress","videoId","timestamp"]}),looped:o({name:["Scene","Video","Looped"],requiredContext:["roomId","episodeId","sceneId","videoId"]})},prompt:{answered:o({name:["Scene","Prompt","Answered"],requiredContext:["roomId","episodeId","sceneId","answer","playerId","deviceId","asGroup"]})},multipleChoice:{answered:o({name:["Scene","Multiple Choice","Answered"],requiredContext:["roomId","episodeId","sceneId","answer","playerId","deviceId","asGroup"]})},buttonPrompt:{pressed:o({name:["Scene","Button Prompt","Pressed"],requiredContext:["roomId","episodeId","sceneId","playerId","deviceId","asGroup"]})},timer:{started:o({name:["Scene","Timer","Started"],requiredContext:["roomId","episodeId","sceneId"]}),ended:o({name:["Scene","Timer","Ended"],requiredContext:["roomId","episodeId","sceneId"]})}}}}};function u(e=[]){return{trackEvent:(t,o={})=>{e.push(a({event:I(t)},o))},trackPageView:(t,o={})=>{e.push(a({pageCategory:I(t)},o))}}}const I=e=>[e].flat().join(" / "),l=e=>{const t=s(a({},e),{email:e.userEmail});return s(a({},t),{acValue:JSON.stringify(t)})},C=()=>globalThis.analytics;function x(){let e=!1;return{trackEvent:(t,o={})=>{const d=C();o.userId&&!e&&(d.identify(o.userId,{email:o.userEmail,name:o.userName}),e=!0),d.track([t].flat().join(" _ "),l(o))},trackPageView:(e,t={})=>{const o=C(),d=[e].flat();o.page(d.slice(0,-1).join(" _ "),d.slice().pop(),l(t))}}}const q=e=>{const t=u(e);return{app:c(t)}},v=()=>({app:c(x())});export{x as createSegmentProvider,v as createSegmentRecorder,u as createTagManagerProvider,q as createTagManagerRecorder};
//# sourceMappingURL=analytics.es.js.map
